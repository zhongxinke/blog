# 垃圾回收机制

## 什么是垃圾

在编程语言中，用不到的对象和不再使用的对象称为垃圾

## 为什么要回收

定义变量时需要分配内存
而这些垃圾对象还占用着内存空间，回收实际上就是回收内存空间，如果不及时回收，会导致内存泄漏

## 如何回收垃圾

浏览器引擎会在一段时间内自动回收垃圾，也就是检查哪些对象不再使用。
如何检查哪些对象不再使用，有两种算法：

1. 引用计数
2. 标记清除（目前所有浏览器都使用该算法）

现在的chrome v8引擎是在标记清除基础上进行优化（分布式垃圾回收）

- 引用计数法

这是最初的垃圾收集算法，对象有没有其他对象引用到它，如果没有引用指向该对象，则该对象就被垃圾回收机制回收

缺点：1.需要使用计数器 2.循环引用

- 标记清除法

步骤：

1. 垃圾收集器在运行时会给内存中的所有变量都加上一个标记，假设内存中所有对象都是垃圾，全标记为0
2. 然后从各个根对象开始遍历，把不是垃圾的节点改成1
3. 清理所有标记为0的垃圾，销毁并回收它们所占用的内存空间
4. 最后，把所有内存中对象标记修改为0，等待下一轮垃圾回收

缺点：出现内存碎片

导致内存碎片是因为剩余空闲内存不是一整块，它是由不同大小内存组成的内存列表，这就牵扯出了内存分配的问题

## v8对GC的优化

**分布式垃圾回收**

- 新老生代

将堆内存分为新老生代区域

## 手动设置

1. 将对象设置为null
2. 使用**delete**
